var jwt = require('jsonwebtoken'),
    promises = require('azure-mobile-apps.core/promises');

module.exports = {
    validate: function (config, token) {
        return promises.create(function (resolve, reject) {
            jwt.verify(token, config.secret, function (err, claims) {
                if(err)
                    reject(err);
                else
                    resolve(claims);
            });
        });
    }
};
