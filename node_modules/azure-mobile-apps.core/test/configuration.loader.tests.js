var expect = require('chai').expect,
    path = require('path');

describe('azure-mobile-apps.core.configuration.loader', function () {
    var loader = require('azure-mobile-apps.core/configuration/loader');
    
    it('loads configuration from single file', function () {
        var configuration = loader.loadPath('./files/table1');
        expect(configuration).to.deep.equal({
            table1: { authenticate: true }
        });
    });

    it('loads configuration recursively from directory and adds to target', function () {
        var configuration = loader.loadPath('./files');
        expect(configuration).to.deep.equal({
            table1: { authenticate: true },
            table2: { authenticate: false },
            table3: { softDelete: true }
        });
    });

    it('loads files specified with .js extension', function () {
        var configuration = loader.loadPath('./files/table1.js');
        expect(configuration).to.deep.equal({
            table1: { authenticate: true }
        });
    });

    it('loads relative to basePath', function () {
        var configuration = loader.loadPath('./test/files/table1.js', path.resolve(__dirname, '..'));
        expect(configuration).to.deep.equal({
            table1: { authenticate: true }
        });
    });
});