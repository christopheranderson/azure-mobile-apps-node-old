var statements = require('./statements'),
    execute = require('./execute');

module.exports = function (configuration) {
    return {
        read: function (table, query) {
            return execute(configuration, statements.read(query));
        },
        update: function (table, item) {
            return execute(configuration, statements.update(table.name, item));
        },
        insert: function (table, item) {
            return execute(configuration, statements.insert(table.name, item));
        },
        delete: function (table, id, version) {
            return execute(configuration, statements.delete(table.name, id, version));
        },
        truncate: function (table) {
            return execute(configuration, statements.truncate(table.name));
        }
    };
};
