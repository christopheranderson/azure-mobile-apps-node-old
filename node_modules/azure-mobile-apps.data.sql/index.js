var operations = require('./operations'),
    execute = require('./execute');

module.exports = function (configuration) {
    return {
        get: function (query) {
            return execute(configuration.data, operations.read(query));
        },
        patch: function (table, item) {
            return execute(configuration.data, operations.update(table, item));
        },
        post: function (table, item) {
            return execute(configuration.data, operations.insert(table, item));
        },
        delete: function (table, id, version) {
            return execute(configuration.data, operations.delete(table, id, version));
        }
    }
}
