var statements = require('./statements'),
    execute = require('./execute');

module.exports = function (configuration) {
    return function (table) {
        return {
            read: function (query) {
                return execute(configuration, statements.read(query));
            },
            update: function (item) {
                return execute(configuration, statements.update(table, item));
            },
            insert: function (item) {
                return execute(configuration, statements.insert(table, item));
            },
            delete: function (id, version) {
                return execute(configuration, statements.delete(table, id, version));
            },
            truncate: function () {
                return execute(configuration, statements.truncate(table));
            }
        };
    };
};
