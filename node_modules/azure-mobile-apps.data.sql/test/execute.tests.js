var execute = require('../execute'),
    operations = require('../operations'),
    expect = require('chai').expect;

describe('azure-mobile-apps.data.sql.execute', function () {
    var config = {
        user: 'dale',
        password: 'Blah1234',
        server: 'localhost',
        database: 'test'
    };

    it("basic connection test", function () {
        return execute(config, { sql: 'select * from test', parameters: [] });
    });

    it("basic integration test", function () {
        return execute(config, operations.insert('test', { id: 1, value: 'test' }))
            .then(function () {
                return execute(config, operations.update('test', { id: 1, value: 'test2' }))
            })
            .then(function () {
                return execute(config, operations.read({ table: 'test' }))
            })
            .then(function (results) {
                expect(results).to.deep.equal([ { id: 1, value: 'test2' }]);
                return execute(config, operations.delete('test', 1));
            });
    });
});
