var index = require('..'),
    queries = require('azure-mobile-apps.query'),
    expect = require('chai').expect;

describe('azure-mobile-apps.data.sql.integration.query', function () {
    var config = {
            user: 'azure-mobile-apps-test',
            password: 'Blah1234',
            server: 'localhost',
            database: 'azure-mobile-apps-test'
        },
        operations = index(config),
        queryTable = { name: 'query' };

    it("filters on equality", function () {
        return operations.read(queryTable, queries.create('query').where({ number: 1 }))
            .then(function (results) {
                expect(results).to.deep.equal([{ bool: true, id: 1, number: 1, string: 'one' }]);
            });
    });

    it("selects columns", function () {
        return operations.read(queryTable, queries.create('query').where({ number: 1 }).select('id, string'))
            .then(function (results) {
                expect(results).to.deep.equal([{ id: 1, string: 'one' }]);
            });
    });
});
