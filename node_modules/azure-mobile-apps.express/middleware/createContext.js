var data = require('azure-mobile-apps.core/data');

module.exports = function (configuration) {
    var provider = data(configuration);

    return function (req, res, next) {
        req.azureMobile = {
            req: req,
            res: res,
            data: provider,
            tables: configuration.tables,
            table: function (name) {
                return provider(configuration.tables[name]);
            }
        };
        next();
    };
};
