var express = require('express'),
    log = require('azure-mobile-apps.core/logger');

module.exports = function (rootPath) {
    var router = express.Router(),
        result = function (req, res, next) {
            router(req, res, next);
        };

    result.add = function (name, definition) {
        if (definition.constructor === Function)
            definition = definition(name);

        log.debug("Adding table definition for " + name);
        router.use('/', definition);
    };

    result.stack = router.stack;

    return result;
}
