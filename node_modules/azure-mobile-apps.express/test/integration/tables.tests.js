var expect = require('chai').expect,
    supertest = require('supertest'),
    express = require('express'),
    mobileApps = require('azure-mobile-apps.express'),

    app, mobileApp;

describe('azure-mobile-apps.express.integration.tables', function () {
    beforeEach(function () {
        app = express();
        mobileApp = mobileApps();
    });    

    it('returns 200 for table route', function (done) {
        mobileApp.tables.add('todoitem');
        mobileApp.attach(app);
        
        supertest(app)
            .get('/tables/todoitem')
            .expect(200)
            .end(done);
    });

    it('returns 200 for table route with id parameter', function (done) {
        mobileApp.tables.add('todoitem');
        mobileApp.attach(app);
        
        supertest(app)
            .get('/tables/todoitem/id')
            .expect(200)
            .end(done);
    });

    it('executes user code when provided', function (done) {
        var table = mobileApp.table();
        table.read(function (query, context) {
            
        });
        mobileApp.tables.add('todoitem');
    });
})
