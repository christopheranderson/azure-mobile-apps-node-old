var mobileApps = require('..'),
    expect = require('chai').expect;

describe('azure-mobile-apps.configuration', function () {
    it("does not override configuration with defaults", function () {
        var mobileApp = mobileApps({ tableRootPath: 'test' });
        expect(mobileApp.configuration.tableRootPath).to.equal('test');
    });

    it("sets table configuration from environment variable", function () {
        process.env.MS_TableConnectionString = 'Server=tcp:azure-mobile-apps-test.database.windows.net,1433;Database=e2etest-v2-node;User ID=azure-mobile-apps-test@azure-mobile-apps-test;Password=abc123;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;';
        var mobileApp = mobileApps();
        expect(mobileApp.configuration.data.server).to.equal('azure-mobile-apps-test.database.windows.net');
        expect(mobileApp.configuration.data.port).to.equal(1433);
        process.env.MS_TableConnectionString = undefined;
    });
});
