module.exports = function (configuration) {
    return {
        middleware: function (err, req, res, next) {
            if (err)
                res.status(500).end(configuration.debug ? JSON.stringify({ message: err.message, stack: err.stack }) : "An error occurred");
            else
                next();
        }
    };
};