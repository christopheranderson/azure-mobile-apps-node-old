module.exports = function (configuration) {
    var api = require('./api')(configuration),
        auth = require('./auth')(configuration),
        error = require('./error')(configuration),
        push = require('./push')(configuration),
        tables = require('./tables')(configuration),
        log = require('zumo.core/logger');

    return {
        attach: function (app) {
            log.system.debug('Attaching to express app');

            app.use(api.middleware);
            //app.use(auth.middleware);
            //app.use(push.middleware);
            app.use(tables.middleware);
            app.use(error.middleware);
        },
        api: api,
        auth: auth,
        push: push,
        tables: tables,
        configuration: configuration
    };
}